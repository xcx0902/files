模拟

由于是大模拟，不再赘述。细节详见代码。
