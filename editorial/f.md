组合数学 + 二项式定理

------

$20$ pts：暴力（不再赘述）

------

$50$ pts：

前置知识：二项式定理：

$$\sum_{i=0}^m x^i \cdot y^{m-i} \cdot C_m^i=(x+y)^m$$

然后，我们发现原来的式子中就有这个东西，于是把它提取出来后得：

$$\sum_{i=1}^m \sum_{j=1}^n \sum_{k=1}^n (j+k)^i$$

可以发现，上面这个式子与 $j, k$ 无关，只与 $j+k$ 有关。

然后，我们就可以枚举 $j+k$，将 $O(n^3)$ 优化为 $O(n^2)$。

新式子如下：

$$\sum_{i=1}^m \sum_{j=1}^{2 \times n} T \times j^i$$

其中，$T = n-|j-n-1|$。

原因如下：

当 $j=2$ 时，$1$ 次计算，

当 $j=3$ 时，$2$ 次计算，

当 $j=n+1$ 时，$n$ 次计算，

当 $j=2 \times n - 1$ 时，$2$ 次计算，

当 $j=2 \times n$ 时，$1$ 次计算。

------------

$100$ pts：

我们可以交换式子的两层循环，答案不变，即为

$$\sum_{j=1}^{2 \times n} T \times \sum_{i=1}^m j^i$$

我们需要快速计算

$$\sum_{i=1}^m j^i$$

将该式乘 $j$ 再减去该式，得到

$$j^{m+1}-1=(j-1)*\sum_{i=1}^m j^i$$

即

$$\sum_{j=1}^{m} j^i=\frac{j^{m+1}-1}{j-1}$$

带入原式，得到

$$\sum_{j=1}^{2 \times n} T\times\frac{j^{m+1}-1}{j-1}$$

由于 $10^9+7$ 是质数，所以求出 $j-1$ 的逆元即可。

时间复杂度：$O(n^2)$